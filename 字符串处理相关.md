### UITextFiledæˆ–UITextViewå­—æ•°é™åˆ¶æœ€å¥½çš„æ–¹æ³•
[Objcä¸­å›½](https://objccn.io/issue-9-1/)
 - å¹¸è¿çš„æ˜¯ï¼ŒNSString æœ‰æ›´å¥½åœ°æ–¹å¼ï¼šenumerateSubstringsInRange:options:usingBlock: æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æŠŠ 
 Unicode æŠ½è±¡çš„åœ°æ–¹éšè—äº†ï¼Œèƒ½è®©ä½ è½»æ¾åœ°å¾ªç¯å­—ç¬¦ä¸²é‡Œçš„ç»„åˆå­—ç¬¦ä¸²ã€å•è¯ã€è¡Œã€å¥å­æˆ–æ®µè½ã€‚
 ä½ ç”šè‡³å¯ä»¥åŠ ä¸Š NSStringEnumerationLocalized è¿™ä¸ªé€‰é¡¹ï¼Œè¿™æ ·å¯ä»¥åœ¨ç¡®å®šè¯è¯­é—´å’Œå¥å­é—´çš„è¾¹ç•Œæ—¶æŠŠç”¨æˆ·æ‰€åœ¨çš„åŒºåŸŸè€ƒè™‘è¿›å»ã€‚
 è¦éå†å•ä¸ªå­—ç¬¦ï¼ŒæŠŠå‚æ•°æŒ‡å®šä¸º NSStringEnumerationByComposedCharacterSequencesï¼š
 - è¿™ä¸ªå¥‡å¦™çš„æ–¹æ³•è¡¨æ˜ï¼Œè‹¹æœæƒ³è®©æˆ‘ä»¬æŠŠå­—ç¬¦ä¸²çœ‹åšå­å­—ç¬¦ä¸²çš„é›†åˆï¼Œè€Œä¸æ˜¯ï¼ˆè‹¹æœæ„ä¹‰ä¸Šçš„ï¼‰å­—ç¬¦çš„é›†åˆï¼Œå› ä¸º
    - å•ä¸ª unichar å¤ªå°ï¼Œä¸è¶³ä»¥ä»£è¡¨ä¸€ä¸ªçœŸæ­£çš„ Unicode å­—ç¬¦ï¼›
    - ä¸€äº›ï¼ˆæ™®éæ„ä¹‰ä¸Šçš„ï¼‰å­—ç¬¦ç”±å¤šä¸ª Unicode ç ç‚¹ç»„æˆã€‚
    - è¯·æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•çš„åŠ å…¥ç›¸å¯¹æ™šä¸€äº›ï¼ˆåœ¨ OS X 10.6 å’Œ iOS 4.0 çš„æ—¶å€™ï¼‰ã€‚åœ¨ä¹‹å‰ï¼ŒæŒ‰å­—ç¬¦å¾ªç¯ä¸€ä¸ªå­—ç¬¦ä¸²è¦éº»çƒ¦å¾—å¤šã€‚
 
```objc
NSString *s = @"The weather on \U0001F30D is \U0001F31E today.";  
// The weather on ğŸŒ is ğŸŒ today.  
NSRange fullRange = NSMakeRange(0, [s length]);  
[s enumerateSubstringsInRange:fullRange  
                      options:NSStringEnumerationByComposedCharacterSequences  
                   usingBlock:^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop)
{
    NSLog(@"%@ %@", substring, NSStringFromRange(substringRange));
}];
```

### å¯Œæ–‡æœ¬å­—ç¬¦è¿æ¥å¤„ç†(è‡ªåŠ¨æ–­å­—)
- TextKitçš„å¯Œæ–‡æœ¬å±æ€§
```
\*
 Hyphenation is attempted when the ratio of the text width (as broken without hyphenation) to the width of the line fragment is less than the hyphenation factor. When the paragraphâ€™s hyphenation factor is 0.0, the layout managerâ€™s hyphenation factor is used instead. When both are 0.0, hyphenation is disabled. This property detects the user-selected language by examining the first item in preferredLanguages
*\
iOS ä¸­éå¸¸ç®€å•ï¼ŒTextKit æä¾›äº†è‰¯å¥½çš„è‡ªåŠ¨æ–­å­—æ”¯æŒï¼Œå¯ä»¥é€šè¿‡è®¾ç½® hyphenationFactor å±æ€§éå¸¸æ–¹ä¾¿çš„å®ç°è‡ªåŠ¨æ–­å­—ï¼š
let paragraphStyle = NSMutableParagraphStyle()
    paragraphStyle.hyphenationFactor = 1
    paragraphStyle.alignment = .center
    
#import "NSLocale+ForceHyphenation.h"

@implementation NSLocale (ForceHyphenation)

+ (void)load {
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{

        SEL originalSelector = @selector(preferredLanguages);
        SEL swizzledSelector = @selector(sr_preferredLanguages);

        Class class = object_getClass((id)self);
        Method originalMethod = class_getClassMethod(class, originalSelector);
        Method swizzledMethod = class_getClassMethod(class, swizzledSelector);

        BOOL didAddMethod =
        class_addMethod(class,
                        originalSelector,
                        method_getImplementation(swizzledMethod),
                        method_getTypeEncoding(swizzledMethod));

        if (didAddMethod) {
            class_replaceMethod(class,
                                swizzledSelector,
                                method_getImplementation(originalMethod),
                                method_getTypeEncoding(originalMethod));
        } else {
            method_exchangeImplementations(originalMethod, swizzledMethod);
        }
    });
}
+ (NSArray <NSString *> *)sr_preferredLanguages {
    [self sr_preferredLanguages];
    return @[ @"en" ];
}

@end
```
- åˆ©ç”¨YYTextè®¾ç½®truncationTokenå¯ä»¥å®Œç¾çš„å®ç°è¿™é¡¹åŠŸèƒ½ï¼Œè€Œä¸”æ•ˆç‡æ¯”è¿™ä¸ªé«˜
- æ‰©å±•å¤„ç†çš„ç®€å•æ–¹æ³•
```objc
#import "NSString+SoftHyphenation.h"
unichar const kTextDrawingSoftHyphenUniChar = 0x00AD;
NSString * const kTextDrawingSoftHyphenToken = @"\u00ad"; // NOTE: UTF-8 soft hyphen!

NSString * const NSStringSoftHyphenationErrorDomain = @"NSStringSoftHyphenationErrorDomain";

@implementation NSString (SoftHyphenation)

- (NSError *)hyphen_createOnlyError
{
    NSDictionary *userInfo = @{
                               NSLocalizedDescriptionKey: @"Hyphenation is not available for given locale",
                               NSLocalizedFailureReasonErrorKey: @"Hyphenation is not available for given locale",
                               NSLocalizedRecoverySuggestionErrorKey: @"You could try using a different locale even though it might not be 100% correct"
                               };
    return [NSError errorWithDomain:NSStringSoftHyphenationErrorDomain code:NSStringSoftHyphenationErrorNotAvailableForLocale userInfo:userInfo];
}

- (NSString *)softHyphenatedStringWithLocale:(NSLocale *)locale error:(out NSError **)error
{
    CFLocaleRef localeRef = (__bridge CFLocaleRef)(locale);
    if(!CFStringIsHyphenationAvailableForLocale(localeRef))
    {
        if(error != NULL)
        {
            *error = [self hyphen_createOnlyError];
        }
        return [self copy];
    }
    else
    {
        NSMutableString *string = [self mutableCopy];
        unsigned char hyphenationLocations[string.length];
        memset(hyphenationLocations, 0, string.length);
        CFRange range = CFRangeMake(0, string.length);
        
        for(int i = 0; i < string.length; i++)
        {
            CFIndex location = CFStringGetHyphenationLocationBeforeIndex((CFStringRef)string,
                                                                         i,
                                                                         range,
                                                                         0,
                                                                         localeRef,
                                                                         NULL);
            
            if(location >= 0 && location < string.length)
            {
                hyphenationLocations[location] = 1;
            }
        }
        
        for(unsigned long i = string.length - 1; i > 0; i--)
        {
            if(hyphenationLocations[i])
            {
                [string insertString:kTextDrawingSoftHyphenToken atIndex:i];
            }
        }
        
        if(error != NULL) { *error = nil;}
        
        return string;
    }
}


- (NSString *)softHyphenatedString
{
    NSLocale *locale = [NSLocale localeWithLocaleIdentifier:@"en_US"];
    return [self softHyphenatedStringWithLocale:locale error:nil];
}


@end
```
